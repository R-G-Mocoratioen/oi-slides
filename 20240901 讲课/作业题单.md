## 作业题提示

下面的作业中，

- 第 $1\sim 7$ 题来自讲义，几乎都是对课上知识的简单重复。
- 第 $8,9$ 题引入了“可持久化线段树”的技巧。
- 第 $10,11$ 题展现了一种对于特殊操作的处理方式。
- 第 $12\sim 15$ 题是拓展延伸，只需要用课上讲过的知识就能解决，但难度可不小。

1. 洛谷 P5024
   
   考察求出不带修答案的树形 dp。需要记录每个子树的根选不选。

   如果固定了 $x,y$ 分别是否选，那就是它到祖先的路径上的点的 dp 值会变。可以拆分为 $x\to lca,y\to lca,lca\to root$ 三部分。这三段路径把整棵树分成了三部分。

   对于这三段路径，问题都形如：“固定路径端点处选不选，这段路径及其延伸出去的所有子树的最小代价是多少”。这个信息是可合并的（可以参考“数据传输”一题的合并方式），因此可以倍增维护。

2. Codeforces 1988E
   
   建笛卡尔树后，删去 $x$，$x$ 子树中左儿子的右链（不停走右儿子得到的链）和右儿子的左链会按照归并排序的方式合起来，暴力合并即可。可以参考 FHQ Treap 的实现。

3. Codeforces 1156E
   
   序列分治，枚举 max 取在哪边。

4. 洛谷 P4169
   
   枚举方位关系，把曼哈顿距离的绝对值拆掉，然后分别分离变量求最值。

5. 洛谷 P3157
   
   考虑每次删元素逆序对数少了多少，加上时间维，是偏序问题。

6. 洛谷 P2487
   
   本题展示了 CDQ 分治在“询问有顺序要求”时的作用。对时间分治，按照下面的流程处理：

   - 递归时间 $[l,mid]$。
   - 用二维偏序问题的方式处理 $[l,mid]$ 的 dp 值对 $[mid+1,r]$ 的转移。
   - 递归时间 $[mid+1,r]$。
  
   时间复杂度同一般的三维偏序。

7. 洛谷 P4755
   
   最值分治，枚举小的那边，转化为 $O(n\log n)$ 个二维偏序问题。

8. 洛谷 P4602
   
   最小值最大二分答案，在美味度有下界的前提下，为了满足要求，一定优先取价格小的果汁。这个过程可以在可持久化线段树上二分完成。

9.  洛谷 P3293
    
    按位贪心。贪心过程中的判定问题是：“是否有 $i\in [l,r]$ 使得 $(a_i+x)\ \mathrm{xor}\ y$ 的高位为当前贪心得到的值？”，这个问题其实就是要求 $a_i$ 属于一个特定的区间，可以可持久化线段树回答。

10. 洛谷 P4145
    
    记录每个数是否已经小于等于 1，如果不是的话就 dfs 子结点，找到所有应该开根的数并开根。每次找数的代价是 $O(\log n)$，总共找数的次数 $\le \log log V\times n$。

11. Codeforces 438D
    
    同上题，每次取模操作只要取了，则被取模的数至少减小一半，所以仍然可以维护区间最大值来快速找出被取模的数。

12. QOJ 3857
    
    把题目读懂后就是求前缀和最接近总和一半的两个位置，线段树上二分解决。

13. 洛谷 P8552
    
    建立图的 Kruskal 重构树，自底向上贪心。

14. Codeforces 1583H
    
    从大到小加边，在加入边权 $\ge v$ 的边后回答 $v$ 对应的询问。第一问，只需要在并查集上维护连通块点权最大值。

    关键观察：$x$ 到一些点的最大费用，等于这些点之间的最大费用，并上 $x$ 到其中任一点的最大费用。因此只需维护最大点权点间的最大费用，以及任一最大点权点的编号。（可画图理解）

    合并方式类比“最大值个数”：若左边最大值和右边最大值不同，直接赋值为大的的信息。否则，利用记录的点的编号，新信息就是左右信息的较大者，再并上两边任意一个点之间的路径。

15. 洛谷 P8518
    
    本题展现了扫描线维度的不对称性。对位置扫描线，用线段树维护时间维，则只需线段树上二分找出糖果数量落差超过容量的最靠后的后缀即可。